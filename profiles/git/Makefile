SHELL = sh
UNAME := $(shell uname)

ifeq ($(UNAME), Darwin)
SED_INPLACE_ARG ?= ''
endif

PROFILE_FILENAME ?= .gitconfig
PROFILE ?= $(HOME)/$(PROFILE_FILENAME)

GOH_GITDOTFILES_DIR ?= $(CURDIR)
CONFIG_TEMPLATE_FILE ?= $(GOH_GITDOTFILES_DIR)/config-template
COMMIT_TEMPLATE_FILE ?= $(GOH_GITDOTFILES_DIR)/commit-template
TEMPLATES_DIRECTORY ?= $(GOH_GITDOTFILES_DIR)/git-templates

TMP_CONFIG_FILE ?= /tmp/goh_gitconfig

install:
	cp -v $(CONFIG_TEMPLATE_FILE) $(TMP_CONFIG_FILE)
	sed -i $(SED_INPLACE_ARG) 's@{{COMMIT_TEMPLATE_FILE}}@$(COMMIT_TEMPLATE_FILE)@g' $(TMP_CONFIG_FILE)
	sed -i $(SED_INPLACE_ARG) 's@{{TEMPLATES_DIRECTORY}}@$(TEMPLATES_DIRECTORY)@g' $(TMP_CONFIG_FILE)
	mv -v $(TMP_CONFIG_FILE) $(PROFILE)
